/**
 * @remix-run/dev v2.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var plugin = require('../plugin.js');

const importWrangler = async () => {
  try {
    return await import('wrangler');
  } catch (_) {
    throw Error("Could not import `wrangler`. Do you have it installed?");
  }
};

/**
 * @param options.getRemixDevLoadContext - Augment the load context.
 */
const preset = (options = {}) => ({
  name: "cloudflare",
  remixConfig: async () => {
    let {
      getBindingsProxy
    } = await importWrangler();
    let {
      bindings
    } = await getBindingsProxy();
    let loadContext = {
      env: bindings
    };
    if (options.getRemixDevLoadContext) {
      loadContext = await options.getRemixDevLoadContext(loadContext);
    }
    plugin.setRemixDevLoadContext(loadContext);
    return {};
  }
});

exports.preset = preset;
